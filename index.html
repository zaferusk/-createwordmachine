<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Word Machine</title>
  <style>
    body {
      font-family: 'Comic Sans MS', cursive, sans-serif;
      background: linear-gradient(to right, #fef6e4, #fcd5ce);
      color: #001858;
      padding: 20px;
      text-align: center;
    }
    h1 {
      font-size: 3em;
      color: #ff006e;
    }
    input, select {
      padding: 10px;
      border-radius: 10px;
      border: 2px solid #8bd3dd;
      margin: 5px;
      font-size: 1em;
    }
    button {
      padding: 10px 20px;
      border: none;
      border-radius: 10px;
      font-size: 18px;
      cursor: pointer;
      margin: 10px;
      transition: transform 0.2s;
    }
    button:hover {
      transform: scale(1.05);
    }
    #word-box {
      font-size: 36px;
      margin: 20px auto;
      padding: 20px;
      background: white;
      border-radius: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      width: 60%;
    }
    #timer {
      font-size: 20px;
      font-weight: bold;
      color: #dc2f02;
    }
    #scoreboard {
      margin-top: 20px;
      font-size: 1.2em;
      background-color: #fff3c7;
      padding: 10px;
      border-radius: 10px;
      display: inline-block;
    }
    #extra-info {
      font-size: 1.1em;
      margin-top: 10px;
      color: #6a040f;
    }
    #score-container {
      position: fixed;
      top: 10px;
      right: 10px;
      background: #fff3c7;
      padding: 10px 20px;
      border-radius: 15px;
      font-weight: bold;
      font-size: 16px;
      color: #6a040f;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      z-index: 1000;
    }
    #start-section, #category-section, #game-section, #word-form {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div id="score-container">Scoreboard: Player 1: 0 | Player 2: 0</div>
  <h1>üéÆ Word Machine</h1>

  <div id="start-section">
    <input id="player1" placeholder="Player 1 Name" />
    <input id="player2" placeholder="Player 2 Name" />
    <button id="start-btn">Start Game</button>
  </div>

  <div id="category-section" style="display:none;">
    <h2>Select a Category:</h2>
    <button class="category-btn" data-cat="Nature">üå≥ Nature</button>
    <button class="category-btn" data-cat="Sports">üèÄ Sports</button>
    <button class="category-btn" data-cat="Animals">üêæ Animals</button>
  </div>

  <div id="game-section" style="display:none;">
    <div id="player-turn"></div>
    <div id="word-box">Waiting...</div>
    <div id="timer">‚è≥ 10</div>
    <button id="know-btn">‚úÖ I Know</button>
    <button id="dontknow-btn">‚ùå I Don't Know</button>
    <button id="joker-btn">üÉè Use Joker (<span id="joker-count">3</span>)</button>
    <div id="extra-info"></div>
    <div id="scoreboard"></div>
  </div>

  <div id="word-form">
    <h2>‚ûï Add New Word</h2>
    <input id="new-word" placeholder="English Word" />
    <input id="new-tr" placeholder="Turkish Meaning" />
    <input id="new-example" placeholder="Example Sentence" />
    <select id="new-category">
      <option value="">Select Category</option>
      <option value="Nature">üå≥ Nature</option>
      <option value="Sports">üèÄ Sports</option>
      <option value="Animals">üêæ Animals</option>
    </select>
    <button id="add-btn">üì§ Add Word</button>
  </div>

  <audio id="success-sound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_6f5a1c3d0e.mp3"></audio>

  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const firebaseConfig = {
        apiKey: "AIzaSyBiEB9J0OIr9hPGR_NB0U13wrjA0QBF7sk",
        authDomain: "word-machine-547d3.firebaseapp.com",
        projectId: "word-machine-547d3",
        storageBucket: "word-machine-547d3.firebasestorage.app",
        messagingSenderId: "537964257136",
        appId: "1:537964257136:web:045c49422b46541af1b9b5",
        measurementId: "G-2ST0PGHT6K"
      };
      firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();

      let gameWords = [];
      let currentCategory = "";
      let currentWord = {};
      let playerNames = ["", ""];
      let scores = [0, 0];
      let currentPlayer = 0;
      let jokers = [3, 3];
      let timerInterval;
      let timeLeft = 10;
      let roundCount = 0;
      const maxRounds = 10;

      const startSection = document.getElementById('start-section');
      const categorySection = document.getElementById('category-section');
      const gameSection = document.getElementById('game-section');
      const wordForm = document.getElementById('word-form');

      document.getElementById('start-btn').addEventListener('click', startGame);
      document.querySelectorAll('.category-btn').forEach(btn => {
        btn.addEventListener('click', () => chooseCategory(btn.dataset.cat));
      });
      document.getElementById('know-btn').addEventListener('click', iKnow);
      document.getElementById('dontknow-btn').addEventListener('click', iDontKnow);
      document.getElementById('joker-btn').addEventListener('click', useJoker);
      document.getElementById('add-btn').addEventListener('click', addWordToFirebase);

      function startGame() {
        playerNames[0] = document.getElementById("player1").value || "Player 1";
        playerNames[1] = document.getElementById("player2").value || "Player 2";
        startSection.style.display = 'none';
        categorySection.style.display = 'block';
      }

      function chooseCategory(cat) {
        currentCategory = cat;
        categorySection.style.display = 'none';
        gameSection.style.display = 'block';
        gameWords = [];
        roundCount = 0;
        db.collection("words").where("category", "==", currentCategory).get()
          .then(snapshot => {
            snapshot.forEach(doc => gameWords.push(doc.data()));
            if (!gameWords.length) {
              alert("No words found in this category.");
              gameSection.style.display = 'none';
              startSection.style.display = 'block';
              return;
            }
            nextWord();
          })
          .catch(err => console.error(err));
      }

      function nextWord() {
        clearInterval(timerInterval);
        roundCount++;
        if (roundCount > maxRounds) {
          alert(`üéâ Game Over! Final Score:\n${playerNames[0]}: ${scores[0]}\n${playerNames[1]}: ${scores[1]}`);
          gameSection.style.display = 'none';
          startSection.style.display = 'block';
          return;
        }
        timeLeft = 10;
        document.getElementById("timer").innerText = `‚è≥ ${timeLeft}`;
        timerInterval = setInterval(updateTimer, 1000);
        currentWord = gameWords[Math.floor(Math.random() * gameWords.length)];
        document.getElementById("word-box").innerText = currentWord.word;
        document.getElementById("player-turn").innerText = `Your turn: ${playerNames[currentPlayer]}`;
        document.getElementById("extra-info").innerText = "";
        document.getElementById("joker-count").innerText = jokers[currentPlayer];
      }

      function updateTimer() {
        timeLeft--;
        document.getElementById("timer").innerText = `‚è≥ ${timeLeft}`;
        if (timeLeft <= 0) {
          clearInterval(timerInterval);
          iDontKnow();
        }
      }

      function iKnow() {
        clearInterval(timerInterval);
        const earned = [5, 10, 15, 20][Math.floor(Math.random() * 4)];
        scores[currentPlayer] += earned;
        const info = document.getElementById("extra-info"); info.innerText = `üéâ +${earned} points!`;
        document.getElementById("success-sound").play();
        updateScoreboard();
        switchPlayer();
        setTimeout(nextWord, 500);
      }

      function iDontKnow() {
        clearInterval(timerInterval);
        document.getElementById("extra-info").innerText = `${currentWord.tr} - ${currentWord.example}`;
        switchPlayer();
        setTimeout(nextWord, 2000);
      }

      function switchPlayer() { currentPlayer = (currentPlayer + 1) % 2; }

      function updateScoreboard() {
        const txt = `${playerNames[0]}: ${scores[0]} | ${playerNames[1]}: ${scores[1]}`;
        document.getElementById("scoreboard").innerText = txt;
        document.getElementById("score-container").innerText = "Scoreboard: " + txt;
      }

      function useJoker() {
        if (jokers[currentPlayer] > 0) {
          jokers[currentPlayer]--;
          document.getElementById("extra-info").innerText = `Hint: ${currentWord.tr}`;
          document.getElementById("joker-count").innerText = jokers[currentPlayer];
        } else {
          document.getElementById("extra-info").innerText = "No jokers left!";
        }
      }

      function addWordToFirebase() {
        const word = document.getElementById("new-word").value;
        const tr = document.getElementById("new-tr").value;
        const example = document.getElementById("new-example").value;
        const category = document.getElementById("new-category").value;
        if (!word || !tr || !example || !category) { alert("Please fill all fields."); return; }
        db.collection("words").add({ word, tr, example, category })
          .then(() => { alert("Word added successfully!"); })
          .catch(e => { console.error(e); alert("Error adding word."); });
      }
    });
  </script>
</body>
</html>
